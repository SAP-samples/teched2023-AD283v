/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/ColumnListItem","sap/ui/core/IconPool","sap/m/upload/UploadSetwithTableItemRenderer","sap/base/Log","sap/ui/core/Core"],function(e,t,i,s,a){"use strict";var n=e.extend("sap.m.upload.UploadSetwithTableItem",{metadata:{library:"sap.m",properties:{fileName:{type:"string",defaultValue:null},mediaType:{type:"string",defaultValue:null},url:{type:"string",defaultValue:null},uploadUrl:{type:"string",defaultValue:null},uploadState:{type:"sap.m.UploadState",defaultValue:null},previewable:{type:"boolean",defaultValue:true},fileSize:{type:"float",defaultValue:0}},aggregations:{headerFields:{type:"sap.ui.core.Item",multiple:true,singularName:"headerField"}}},render:i});n.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oFileObject=null;this._fFileSize=null;this._bFileTypeRestricted=false;this._bNameLengthRestricted=false;this._bSizeRestricted=false;this._bMediaTypeRestricted=false;this._oRb=a.getLibraryResourceBundle("sap.m")};n.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments)};n.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.call(this)};n.prototype.exit=function(){e.prototype.exit.call(this)};n.prototype.setFileName=function(e){if(this.getFileName()!==e){this.setProperty("fileName",e,true);if(this.getParent()){this._checkNameLengthRestriction(this.getParent().getMaxFileNameLength());this._checkTypeRestriction(this.getParent().getFileTypes())}}return this};n.prototype.getFileObject=function(){return this._oFileObject};n.prototype.openPreview=function(){this.getParent()?._openFilePreview(this)};n.prototype.download=function(e){var t=this.getParent();if(!t){s.warning("Download cannot proceed without a parent association.");return false}return t._getActiveUploader?t._getActiveUploader().download(this,[],e):false};n.prototype.isRestricted=function(){return this._isRestricted()};n._getIconByMimeType=function(e,i){var s=["image/png","image/tiff","image/bmp","image/jpeg","image/gif"];if(e){if(s.indexOf(e)===-1){return t.getIconForMimeType(e)}return n._getIconByFileType(i)}else{return n._getIconByFileType(i)}};n._getIconByFileType=function(e){var t=n._splitFileName(e).extension;if(!t){return"sap-icon://document"}switch(t.toLowerCase()){case"bmp":case"jpg":case"jpeg":case"png":return n.IMAGE_FILE_ICON;case"csv":case"xls":case"xlsx":return"sap-icon://excel-attachment";case"doc":case"docx":case"odt":return"sap-icon://doc-attachment";case"pdf":return"sap-icon://pdf-attachment";case"ppt":case"pptx":return"sap-icon://ppt-attachment";case"txt":return"sap-icon://document-text";default:return"sap-icon://document"}};n._splitFileName=function(e,t){var i={};var s=/(?:\.([^.]+))?$/;var a=s.exec(e);if(!a[0]){a[0]="";i.name=e}else{i.name=e?e.slice(0,e.indexOf(a[0])):""}if(t){i.extension=a[0]}else{i.extension=a[1]}return i};n.prototype._setFileObject=function(e){this._oFileObject=e;if(e){this._fFileSize=e.size/n.MEGABYTE;this.setFileSize(e.size);this.setMediaType(e.type)}else{this._fFileSize=null;this.setMediaType(null)}if(this.getParent()){this._checkSizeRestriction(this.getParent().getMaxFileSize());this._checkMediaTypeRestriction(this.getParent().getMediaTypes())}};n.prototype._checkNameLengthRestriction=function(e){var t=e&&!!this.getFileName()&&this.getFileName().length>e;if(t!==this._bNameLengthRestricted){this._bNameLengthRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireFileNameLengthExceeded({item:this})}}};n.prototype._checkSizeRestriction=function(e){var t=e&&this._fFileSize>e;if(t!==this._bSizeRestricted){this._bSizeRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireFileSizeExceeded({item:this})}}};n.prototype._checkMediaTypeRestriction=function(e){var t=!!e&&e.length>0&&!!this.getMediaType()&&e.indexOf(this.getMediaType())===-1;if(t!==this._bMediaTypeRestricted){this._bMediaTypeRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireMediaTypeMismatch({item:this})}}};n.prototype._checkTypeRestriction=function(e){var t=n._splitFileName(this.getFileName()),i=!!this.getFileName()&&!!e&&e.length>0&&t.extension&&e.indexOf(t.extension.toLowerCase())===-1;if(i!==this._bFileTypeRestricted){this._bFileTypeRestricted=i;this.invalidate();if(i&&this.getParent()){this.getParent().fireFileTypeMismatch({item:this})}}};n.prototype._isRestricted=function(){return this._bFileTypeRestricted||this._bNameLengthRestricted||this._bSizeRestricted||this._bMediaTypeRestricted};n.IMAGE_FILE_ICON="sap-icon://card";n.MEGABYTE=1048576;return n});
//# sourceMappingURL=UploadSetwithTableItem.js.map