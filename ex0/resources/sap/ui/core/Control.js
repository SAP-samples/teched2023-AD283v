/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./CustomStyleClassSupport","./Core","./Element","./UIArea","./StaticArea","./RenderManager","./BusyIndicatorUtils","./BlockLayerUtils","sap/base/Log","sap/ui/performance/trace/Interaction","sap/ui/thirdparty/jquery"],function(t,e,i,s,o,r,n,a,l,c,jQuery){"use strict";var u;var d=i.extend("sap.ui.core.Control",{metadata:{stereotype:"control",abstract:true,publicMethods:["placeAt","attachBrowserEvent","detachBrowserEvent","getControlsByFieldGroup","triggerValidateFieldGroup","checkFieldGroupIds"],library:"sap.ui.core",properties:{blocked:{type:"boolean",defaultValue:false},busy:{type:"boolean",defaultValue:false},busyIndicatorDelay:{type:"int",defaultValue:1e3},busyIndicatorSize:{type:"sap.ui.core.BusyIndicatorSize",defaultValue:"Medium"},visible:{type:"boolean",group:"Appearance",defaultValue:true},fieldGroupIds:{type:"string[]",defaultValue:[]}},events:{validateFieldGroup:{enableEventBubbling:true,parameters:{fieldGroupIds:{type:"string[]"}}}}},constructor:function(t,e){this.bAllowTextSelection=true;i.apply(this,arguments);this.bOutput=this.getDomRef()!=null;this._bOnBeforeRenderingPhase=false},renderer:null});d.prototype.clone=function(){var t=i.prototype.clone.apply(this,arguments);if(this.aBindParameters){for(var e=0,s=this.aBindParameters.length;e<s;e++){var o=this.aBindParameters[e];t.attachBrowserEvent(o.sEventType,o.fnHandler,o.oListener!==this?o.oListener:undefined)}}t.bAllowTextSelection=this.bAllowTextSelection;return t};t.apply(d.prototype);d.prototype.isActive=function(){return document.getElementById(this.sId)!=null};function h(t){if(!t||!t.isA){return false}if(t.isA("sap.ui.core.Control")){return t._bRenderingPhase}return h(t.getParent())}d.prototype.invalidate=function(t){var e;if(this._bOnBeforeRenderingPhase){return}this._bNeedsRendering=true;var i=this.getParent();if((this.bOutput||h(i))&&(e=this.getUIArea())){if(!this._bIsBeingDestroyed){e.addInvalidatedControl(this)}}else{if(i&&!i.isInvalidateSuppressed()&&(this.bOutput||!(this.getVisible&&this.getVisible()===false))){i.invalidate(this)}}};d.prototype.rerender=function(){this._bNeedsRendering=true;s.rerenderControl(this)};d.prototype.getDomRef=function(t){if(this.bOutput===false&&!this.oParent){return null}return i.prototype.getDomRef.call(this,t)};d.prototype.allowTextSelection=function(t){this.bAllowTextSelection=t;return this};d.prototype.attachBrowserEvent=function(t,e,i){if(t&&typeof t==="string"){if(typeof e==="function"){if(!this.aBindParameters){this.aBindParameters=[]}i=i||this;var s=e.bind(i);this.aBindParameters.push({sEventType:t,fnHandler:e,oListener:i,fnProxy:s});if(!this._sapui_bInAfterRenderingPhase){this.$().on(t,s)}}}return this};d.prototype.detachBrowserEvent=function(t,e,i){if(t&&typeof t==="string"){if(typeof e==="function"){var s=this.$(),o,r;i=i||this;if(this.aBindParameters){for(o=this.aBindParameters.length-1;o>=0;o--){r=this.aBindParameters[o];if(r.sEventType===t&&r.fnHandler===e&&r.oListener===i){this.aBindParameters.splice(o,1);s.off(t,r.fnProxy)}}}}}return this};d.prototype.getRenderer=function(){return r.getRenderer(this)};d.prototype.placeAt=function(t,r){e.ready(function(){var e=t;if(typeof t==="string"){e=i.getElementById(t)}if(e instanceof i){if(!y(e)){l.warning("placeAt cannot be processed because container "+e+" does not have an aggregation 'content'.");return this}}else{if(t===o.STATIC_UIAREA_ID||t&&t.id===o.STATIC_UIAREA_ID){e=o.getUIArea()}else{e=s.create(t)}}if(typeof r==="number"){e.insertContent(this,r)}else{r=r||"last";switch(r){case"last":e.addContent(this);break;case"first":e.insertContent(this,0);break;case"only":e.removeAllContent();e.addContent(this);break;default:l.warning("Position "+r+" is not supported for function placeAt.")}}}.bind(this));return this};function y(t){var e=t.getMetadata().getAggregation("content");if(e){return e.multiple&&e.type==="sap.ui.core.Control"}return typeof t.addContent==="function"&&typeof t.insertContent==="function"&&typeof t.removeAllContent==="function"}d.prototype.onselectstart=function(t){if(!this.bAllowTextSelection){t.preventDefault();t.stopPropagation()}};d.prototype.onBeforeRendering=function(t){};d.prototype.onAfterRendering=function(t){};d.prototype.getIdForLabel=function(){return this.getId()};d.prototype.destroy=function(t){if(this.bIsDestroyed){return}this._bIsBeingDestroyed=true;this._cleanupBusyIndicator();u=u||sap.ui.require("sap/ui/core/ResizeHandler");if(u){u.deregisterAllForControl(this.getId())}if(!this.getVisible()){var e=document.getElementById(r.createInvisiblePlaceholderId(this));if(e&&e.parentNode){e.parentNode.removeChild(e)}}i.prototype.destroy.call(this,t)};var f={onBeforeRendering:function(){b.call(this)},onAfterRendering:function(){if(this.getBlocked()&&this.getDomRef()&&!this.getDomRef("blockedLayer")){this._oBlockState=a.block(this,this.getId()+"-blockedLayer",this._sBlockSection);jQuery(this._oBlockState.$blockLayer.get(0)).addClass("sapUiBlockLayerOnly")}if(this.getBusy()&&this.getDomRef()&&!this._busyIndicatorDelayedCallId&&!this.getDomRef("busyIndicator")){var t=this.getBusyIndicatorDelay();if(t){this._busyIndicatorDelayedCallId=setTimeout(p.bind(this),t)}else{p.call(this)}}}};function p(){if(!this.getBusy()){return}var t=this.$(this._sBusySection);if(this._busyIndicatorDelayedCallId){clearTimeout(this._busyIndicatorDelayedCallId);delete this._busyIndicatorDelayedCallId}if(!t||t.length===0){l.warning("BusyIndicator could not be rendered. The outer control instance is not valid anymore.");return}if(this._sBlockSection===this._sBusySection){if(this._oBlockState){n.addHTML(this._oBlockState,this.getBusyIndicatorSize());a.toggleAnimationStyle(this._oBlockState,true);this._oBusyBlockState=this._oBlockState}else{g.call(this)}}else{g.call(this)}}function B(){this._oBlockState=a.block(this,this.getId()+"-blockedLayer",this._sBlockSection);jQuery(this._oBlockState.$blockLayer.get(0)).addClass("sapUiBlockLayerOnly")}function g(){if(this._oBusyBlockState){a.unblock(this._oBusyBlockState)}this._oBusyBlockState=a.block(this,this.getId()+"-busyIndicator",this._sBusySection);n.addHTML(this._oBusyBlockState,this.getBusyIndicatorSize())}function b(){a.unblock(this._oBlockState);a.unblock(this._oBusyBlockState);delete this._oBlockState;delete this._oBusyBlockState}function I(t){if(t){b.call(this);return}var e=this.$(this._sBusySection);e.removeClass("sapUiLocalBusy");if(this._sBlockSection===this._sBusySection){if(!this.getBlocked()&&!this.getBusy()){b.call(this)}else if(this.getBlocked()){a.toggleAnimationStyle(this._oBlockState||this._oBusyBlockState,false);this._oBlockState=this._oBusyBlockState}else if(this._oBusyBlockState){a.unblock(this._oBusyBlockState);delete this._oBusyBlockState}}else if(this._oBusyBlockState){a.unblock(this._oBusyBlockState);delete this._oBusyBlockState}}d.prototype.setBlocked=function(t,e){if(!!t==this.getProperty("blocked")){return this}this._sBlockSection=e||this._sBlockSection;this.setProperty("blocked",t,true);if(t){this.addDelegate(f,false,this)}else if(!this.getBusy()){this.removeDelegate(f)}if(!this.getDomRef()){return this}if(t){if(this._sBlockSection===this._sBusySection){if(!this._oBusyBlockState&&!this._oBlockState){B.call(this)}else{l.info("The control is already busy. Hence, no new block-layer was created for the shared section.")}}else{B.call(this)}}else{if(this._sBlockSection===this._sBusySection){if(!this.getBlocked()&&!this.getBusy()){b.call(this)}else if(this.getBusy()){l.info("The control is already busy. Hence, no new block-layer was created for the shared section.")}}else if(this._oBlockState){a.unblock(this._oBlockState);delete this._oBlockState}}return this};d.prototype.setBusy=function(t,e){if(!!t==this.getProperty("busy")){return this}this._sBusySection=e||this._sBusySection;this.setProperty("busy",t,true);if(t){c.notifyShowBusyIndicator(this);this.addDelegate(f,false,this)}else{if(!this.getProperty("blocked")){this.removeDelegate(f)}if(this._busyIndicatorDelayedCallId){clearTimeout(this._busyIndicatorDelayedCallId);delete this._busyIndicatorDelayedCallId}}if(!this.getDomRef()){return this}if(t){if(this.getBusyIndicatorDelay()<=0){p.call(this)}else{this._busyIndicatorDelayedCallId=setTimeout(p.bind(this),this.getBusyIndicatorDelay())}}else{I.call(this);c.notifyHideBusyIndicator(this)}return this};d.prototype.isBusy=d.prototype.getBusy;d.prototype.setBusyIndicatorDelay=function(t){this.setProperty("busyIndicatorDelay",t,true);return this};d.prototype._cleanupBusyIndicator=function(){if(this._busyIndicatorDelayedCallId){clearTimeout(this._busyIndicatorDelayedCallId);delete this._busyIndicatorDelayedCallId}I.call(this,true)};d.prototype.getControlsByFieldGroupId=function(t){return this.findAggregatedObjects(true,function(e){if(e instanceof d){return e.checkFieldGroupIds(t)}return false})};d.prototype.checkFieldGroupIds=function(t){if(typeof t==="string"){t=t?t.split(","):[]}var e=this._getFieldGroupIds();if(Array.isArray(t)){return t.every(function(t){return e.indexOf(t)>=0})}else if(!t){return e.length>0}return false};d.prototype.triggerValidateFieldGroup=function(t){this.fireValidateFieldGroup({fieldGroupIds:t})};d.getControlsByFieldGroupId=function(t){return i.registry.filter(e=>e.isA("sap.ui.core.Control")&&e.checkFieldGroupIds(t))};return d});
//# sourceMappingURL=Control.js.map